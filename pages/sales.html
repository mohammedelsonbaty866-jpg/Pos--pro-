<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</title>

  <!-- Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù…Ù†ÙŠÙˆ -->
  <link rel="stylesheet" href="../css/menu.css">

  <!-- Ø³ØªØ§ÙŠÙ„ Ø¹Ø§Ù… -->
  <style>
    body {
      margin: 0;
      font-family: Arial;
      background: #f4f6f9;
    }

    .main-content {
      margin-right: 260px;
      padding: 20px;
      transition: 0.3s;
    }

    .sidebar.collapsed ~ .main-content {
      margin-right: 80px;
    }

    .card {
      background: #fff;
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,.08);
    }

    .row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    input, select, button {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
    }

    button {
      cursor: pointer;
      background: #2f6df6;
      color: #fff;
      border: none;
    }

    button.secondary {
      background: #555;
    }

    .pay-btn {
      flex: 1;
      background: #ddd;
      color: #000;
    }

    .pay-btn.active {
      background: #2f6df6;
      color: #fff;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }

    th {
      background: #f0f0f0;
    }

    @media (max-width: 768px) {
      .main-content {
        margin-right: 0;
      }
    }
  </style>
</head>

<body>

<!-- ===== Ø§Ù„Ù…Ù†ÙŠÙˆ ===== -->
<div class="sidebar" id="sidebar">
  <div class="menu-item active" onclick="go('sales.html')">ğŸ§¾ <span class="text">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</span></div>
  <div class="menu-item" onclick="go('purchases.html')">ğŸ“¦ <span class="text">Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</span></div>
  <div class="menu-item" onclick="go('products.html')">ğŸ“‹ <span class="text">Ø§Ù„Ø£ØµÙ†Ø§Ù</span></div>
  <div class="menu-item" onclick="go('returns.html')">â†© <span class="text">Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª</span></div>
  <div class="menu-item" onclick="go('customers.html')">ğŸ‘¤ <span class="text">Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</span></div>
  <div class="menu-item" onclick="go('suppliers.html')">ğŸ­ <span class="text">Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</span></div>
  <div class="menu-item" onclick="go('stock.html')">ğŸ“Š <span class="text">Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</span></div>
  <div class="menu-item" onclick="go('reports.html')">ğŸ“ˆ <span class="text">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span></div>
  <div class="menu-item" onclick="go('expenses.html')">ğŸ’¸ <span class="text">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</span></div>
  <div class="menu-item" onclick="go('cash.html')">ğŸ’° <span class="text">Ø§Ù„Ø®Ø²Ù†Ø©</span></div>
  <div class="menu-item" onclick="go('settings.html')">âš™ <span class="text">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span></div>

  <div class="menu-toggle" onclick="toggleMenu()">â¬…</div>
</div>

<!-- ===== Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ===== -->
<div class="main-content">

  <h2>Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h2>

  <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨ÙŠØ¹ -->
  <div class="card">
    <div class="row">
      <button id="cashBtn" class="pay-btn active">Ù†Ù‚Ø¯ÙŠ</button>
      <button id="creditBtn" class="pay-btn">Ø¢Ø¬Ù„</button>
    </div>

    <input type="text" id="customerName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø¨Ø­Ø« Ø£Ùˆ ÙƒØªØ§Ø¨Ø©)">
  </div>

  <!-- Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù -->
  <div class="card">
    <input type="text" id="productName" placeholder="Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹ Ø¹Ù† Ø§Ù„ØµÙ†Ù">

    <div class="row">
      <select id="unitSelect">
        <option value="ÙƒÙŠÙ„Ùˆ">ÙƒÙŠÙ„Ùˆ</option>
        <option value="Ø¹Ù„Ø¨Ø©">Ø¹Ù„Ø¨Ø©</option>
        <option value="ÙƒØ±ØªÙˆÙ†Ø©">ÙƒØ±ØªÙˆÙ†Ø©</option>
        <option value="Ø¨Ø§ÙƒÙŠØª">Ø¨Ø§ÙƒÙŠØª</option>
      </select>

      <input type="number" id="qtyInput" value="1">
      <button id="addItemBtn">Ø¥Ø¶Ø§ÙØ© Ù„Ù„ÙØ§ØªÙˆØ±Ø©</button>
    </div>
  </div>

  <!-- Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
  <div class="card">
    <div class="row">
      <button id="saveSaleBtn">ğŸ’¾ Ø­ÙØ¸</button>
      <button id="printSaleBtn" class="secondary">ğŸ–¨ Ø·Ø¨Ø§Ø¹Ø©</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Ø§Ù„ØµÙ†Ù</th>
          <th>Ø§Ù„ÙˆØ­Ø¯Ø©</th>
          <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
          <th>Ø§Ù„Ø³Ø¹Ø±</th>
          <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
          <th>Ø­Ø°Ù</th>
        </tr>
      </thead>
      <tbody id="invoiceBody"></tbody>
    </table>

    <input type="number" id="discountInput" placeholder="Ø®ØµÙ… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
    <h3>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="saleTotal">0</span></h3>
  </div>

</div>

<!-- ===== JS ===== -->
<script>
function toggleMenu() {
  document.getElementById("sidebar").classList.toggle("collapsed");
}
function go(page) {
  window.location.href = page;
}

let saleItems = [];
let paymentType = "cash";

const cashBtn = document.getElementById("cashBtn");
const creditBtn = document.getElementById("creditBtn");

cashBtn.onclick = () => {
  paymentType = "cash";
  cashBtn.classList.add("active");
  creditBtn.classList.remove("active");
};

creditBtn.onclick = () => {
  paymentType = "credit";
  creditBtn.classList.add("active");
  cashBtn.classList.remove("active");
};

document.getElementById("addItemBtn").onclick = () => {
  const name = document.getElementById("productName").value;
  const unit = document.getElementById("unitSelect").value;
  const qty = Number(document.getElementById("qtyInput").value);
  if (!name) return alert("Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù");

  const price = 10; // Ù…Ø¤Ù‚Øª
  saleItems.push({ name, unit, qty, price, total: qty * price });
  renderInvoice();
};

function renderInvoice() {
  const body = document.getElementById("invoiceBody");
  const discount = Number(document.getElementById("discountInput").value) || 0;
  let total = 0;
  body.innerHTML = "";

  saleItems.forEach((item, i) => {
    total += item.total;
    body.innerHTML += `
      <tr>
        <td>${i+1}</td>
        <td>${item.name}</td>
        <td>${item.unit}</td>
        <td>${item.qty}</td>
        <td>${item.price}</td>
        <td>${item.total}</td>
        <td><button onclick="removeItem(${i})">âœ–</button></td>
      </tr>
    `;
  });

  document.getElementById("saleTotal").textContent = total - discount;
}

function removeItem(i) {
  saleItems.splice(i, 1);
  renderInvoice();
}

document.getElementById("saveSaleBtn").onclick = () => {
  if (saleItems.length === 0) return alert("Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙØ§Ø¶ÙŠØ©");

  const customer = document.getElementById("customerName").value;
  if (paymentType === "credit" && !customer) {
    return alert("Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø¢Ø¬Ù„");
  }

  const sales = JSON.parse(localStorage.getItem("sales")) || [];
  sales.push({
    id: Date.now(),
    customer: customer || "Ù†Ù‚Ø¯ÙŠ",
    paymentType,
    items: saleItems,
    total: document.getElementById("saleTotal").textContent,
    date: new Date().toLocaleString()
  });
  localStorage.setItem("sales", JSON.stringify(sales));

  alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø©");
  saleItems = [];
  renderInvoice();
};

document.getElementById("printSaleBtn").onclick = () => window.print();
</script>

</body>
</html>
